import{u as h,e as p,f as y,j as c}from"./supabase-vendor-zrCfvSZu.js";import{g as n,s as i,B as w,c as f}from"./index-CcM7G_HG.js";import{H as F,D as d}from"./ui-vendor-D-xBSbyO.js";import{u as q}from"./react-vendor-C2tQq_zP.js";function _(){const{user:t}=n();return h({queryKey:["favorites",t==null?void 0:t.id],queryFn:async()=>{if(!t)return[];const{data:e,error:r}=await i.from("favorites").select("instructor_id").eq("user_id",t.id);if(r)throw r;return e.map(s=>s.instructor_id)},enabled:!!t})}function x(){const t=p(),{user:e}=n();return y({mutationFn:async({instructorId:r,isFavorite:s})=>{if(!e)throw new Error("User not authenticated");if(s){const{error:o}=await i.from("favorites").delete().eq("user_id",e.id).eq("instructor_id",r);if(o)throw o}else{const{error:o}=await i.from("favorites").insert({user_id:e.id,instructor_id:r});if(o)throw o}},onSuccess:()=>{t.invalidateQueries({queryKey:["favorites"]})}})}function A({instructorId:t,className:e,size:r="icon"}){const{isAuthenticated:s}=n(),o=q(),{data:l=[]}=_(),{mutate:v,isPending:m}=x(),a=l.includes(t),g=u=>{if(u.preventDefault(),u.stopPropagation(),!s){o("/login");return}v({instructorId:t,isFavorite:a},{onSuccess:()=>{d.success(a?"Removido dos favoritos":"Adicionado aos favoritos")},onError:()=>{d.error("Erro ao atualizar favoritos")}})};return c.jsx(w,{variant:"ghost",size:r,className:f("hover:bg-transparent",a&&"text-red-500",e),onClick:g,disabled:m,children:c.jsx(F,{className:f("h-5 w-5 transition-all",a&&"fill-red-500")})})}export{A as F,_ as u};
