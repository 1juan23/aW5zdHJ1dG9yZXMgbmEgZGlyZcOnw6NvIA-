import{j as e}from"./supabase-vendor-zrCfvSZu.js";import{u as b,H as y,C as w,a as C,b as V,d as S,e as k,B as d,F as L,s as q}from"./index-CcM7G_HG.js";import{I as B}from"./input-CCzeZ9h-.js";import{L as F}from"./label-BuoQyU_D.js";import{r as l,H as R,L as D}from"./react-vendor-C2tQq_zP.js";import{p as I,Z as H,g as T}from"./validations-BW1-a5ag.js";import{u as O,E as Z}from"./EmailSecurityBadge-Cq55aYub.js";import{g as z,n as A,j as P,L as $,O as M}from"./ui-vendor-D-xBSbyO.js";function _(){const[a,h]=l.useState(""),[n,m]=l.useState(!1),[t,u]=l.useState(!1),[o,x]=l.useState(null),{toast:i}=b(),{validateEmail:p,isValidating:f,validationResult:j,isBlocked:v,clearValidation:g}=O(),E=()=>{x(null);try{return I.parse({email:a}),!0}catch(s){if(s instanceof H){const r=T(s);x(r),i({title:"Erro de validação",description:r,variant:"destructive"})}return!1}},N=async s=>{if(s.preventDefault(),!E())return;const r=await p(a);if((r==null?void 0:r.status)==="BLOQUEADO"){i({title:"Email bloqueado",description:"Este email foi bloqueado por segurança.",variant:"destructive"});return}m(!0);try{const{error:c}=await q.auth.resetPasswordForEmail(a.trim(),{redirectTo:`${window.location.origin}/redefinir-senha`});if(c)throw c;u(!0),i({title:"Email enviado!",description:"Verifique sua caixa de entrada para redefinir sua senha."})}catch{i({title:"Erro",description:"Não foi possível enviar o email. Verifique o endereço informado.",variant:"destructive"})}finally{m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(R,{children:[e.jsx("title",{children:"Recuperar Senha | Instrutores na Direção"}),e.jsx("meta",{name:"description",content:"Recupere sua senha para acessar sua conta na plataforma Instrutores na Direção."})]}),e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[e.jsx(y,{}),e.jsx("main",{className:"flex-1 flex items-center justify-center py-12 px-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-primary text-primary-foreground mb-4",children:e.jsx(z,{className:"h-8 w-8"})}),e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Recuperar senha"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:t?"Verifique seu email para continuar":"Digite seu email para receber o link de recuperação"})]}),e.jsxs(w,{variant:"elevated",children:[e.jsxs(C,{className:"space-y-1 pb-4",children:[e.jsx(V,{className:"text-xl text-center",children:t?"Email enviado!":"Esqueceu sua senha?"}),e.jsx(S,{className:"text-center",children:t?"Clique no link enviado para seu email":"Enviaremos um link para você redefinir sua senha"})]}),e.jsxs(k,{children:[t?e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 text-accent",children:e.jsx(A,{className:"h-8 w-8"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Enviamos um email para ",e.jsx("strong",{className:"text-foreground",children:a})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Não recebeu? Verifique sua pasta de spam ou tente novamente."})]}),e.jsx(d,{variant:"outline",className:"w-full",onClick:()=>u(!1),children:"Tentar outro email"})]}):e.jsxs("form",{onSubmit:N,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(B,{id:"email",type:"email",placeholder:"seu@email.com",className:`pl-10 ${o||v?"border-destructive":""}`,value:a,onChange:s=>{h(s.target.value),g()},onBlur:()=>{a.includes("@")&&p(a)},required:!0,disabled:n||f})]}),e.jsx(Z,{isValidating:f,result:j}),o&&e.jsx("p",{className:"text-xs text-destructive",children:o})]}),e.jsx(d,{type:"submit",size:"lg",className:"w-full",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"mr-2 h-4 w-4 animate-spin"}),"Enviando..."]}):"Enviar link de recuperação"})]}),e.jsx("hr",{className:"my-6"}),e.jsx("div",{className:"text-center",children:e.jsx(D,{to:"/login",children:e.jsxs(d,{variant:"ghost",size:"sm",className:"gap-2 text-muted-foreground",children:[e.jsx(M,{className:"h-4 w-4"}),"Voltar para o login"]})})})]})]})]})}),e.jsx(L,{})]})]})}export{_ as default};
