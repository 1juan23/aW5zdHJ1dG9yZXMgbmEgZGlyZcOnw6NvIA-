import{j as n}from"./supabase-vendor-zrCfvSZu.js";import{c as ue,i as Ie,C as H,a as q,b as K,e as $,B as U,s as I,u as gt,j as yt,H as fe,F as me,h as Ae}from"./index-CcM7G_HG.js";import{D as Ue,a as ze,b as Ve,c as qe,d as bt}from"./dialog-C0xQx6hb.js";import{r as j,u as Ke,n as jt,j as Nt,H as _t}from"./react-vendor-C2tQq_zP.js";import{u as wt}from"./useReviews-DBCGz3pC.js";import{t as k,c as G,s as se,a as Z,g as Le,m as Dt,b as kt,e as Mt,d as B,f as T,h as Ct,i as _e,j as St,k as Pt,l as Ge,p as ne}from"./pt-BR-XEdHDqF9.js";import{a as O,s as ve}from"./subDays-Dj98n0x1.js";import{C as Ot,B as Wt,L as J,q as Ze,D as V,n as he,G as Ft,S as Je,k as It,p as ae,H as At,s as Lt,J as Et,j as Tt,u as Rt}from"./ui-vendor-D-xBSbyO.js";import{u as Bt,a as Yt}from"./useLessons-DS_q4MoL.js";import{u as Xe}from"./useMessages-BNsuwQIj.js";import{P as Ht}from"./PlanBadge-Bd_yppv9.js";import{V as $t}from"./VIPBadge-B08KXLNE.js";import{l as Ut}from"./useProfileViews-DIqDxRyT.js";function L(e,a){const t=k(e);if(isNaN(a))return G(e,NaN);if(!a)return t;const r=t.getDate(),s=G(e,t.getTime());s.setMonth(t.getMonth()+a+1,0);const o=s.getDate();return r>=o?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}function je(e,a){const t=a*7;return O(e,t)}function zt(e,a){return L(e,a*12)}function Vt(e){let a;return e.forEach(function(t){const r=k(t);(a===void 0||a<r||isNaN(Number(r)))&&(a=r)}),a||new Date(NaN)}function qt(e){let a;return e.forEach(t=>{const r=k(t);(!a||a>r||isNaN(+r))&&(a=r)}),a||new Date(NaN)}function W(e,a){const t=se(e),r=se(a);return+t==+r}function X(e,a){const t=k(e),r=k(a),s=t.getFullYear()-r.getFullYear(),o=t.getMonth()-r.getMonth();return s*12+o}function Kt(e,a,t){const r=Z(e,t),s=Z(a,t),o=+r-Le(r),i=+s-Le(s);return Math.round((o-i)/Dt)}function we(e){const a=k(e),t=a.getMonth();return a.setFullYear(a.getFullYear(),t+1,0),a.setHours(23,59,59,999),a}function F(e){const a=k(e);return a.setDate(1),a.setHours(0,0,0,0),a}function De(e,a){var l,c,f,u;const t=kt(),r=(a==null?void 0:a.weekStartsOn)??((c=(l=a==null?void 0:a.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((u=(f=t.locale)==null?void 0:f.options)==null?void 0:u.weekStartsOn)??0,s=k(e),o=s.getDay(),i=(o<r?-7:0)+6-(o-r);return s.setDate(s.getDate()+i),s.setHours(23,59,59,999),s}function Qe(e){return De(e,{weekStartsOn:1})}function Gt(e){const a=k(e),t=a.getFullYear(),r=a.getMonth(),s=G(e,0);return s.setFullYear(t,r+1,0),s.setHours(0,0,0,0),s.getDate()}function Zt(e){return Math.trunc(+k(e)/1e3)}function Jt(e){const a=k(e),t=a.getMonth();return a.setFullYear(a.getFullYear(),t+1,0),a.setHours(0,0,0,0),a}function Xt(e,a){return Kt(Jt(e),F(e),a)+1}function Ne(e,a){const t=k(e),r=k(a);return t.getTime()>r.getTime()}function et(e,a){const t=k(e),r=k(a);return+t<+r}function ke(e,a){const t=k(e),r=k(a);return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()}function Qt(e,a){const t=k(e),r=k(a);return t.getFullYear()===r.getFullYear()}function xe(e,a){const t=k(e),r=t.getFullYear(),s=t.getDate(),o=G(e,0);o.setFullYear(r,a,15),o.setHours(0,0,0,0);const i=Gt(o);return t.setMonth(a,Math.min(s,i)),t}function ea(e,a){const t=k(e);return t.setHours(a),t}function ta(e,a){const t=k(e);return t.setMinutes(a),t}function Ee(e,a){const t=k(e);return isNaN(+t)?G(e,NaN):(t.setFullYear(a),t)}var g=function(){return g=Object.assign||function(a){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(a[o]=t[o])}return a},g.apply(this,arguments)};function aa(e,a){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&a.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)a.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(t[r[s]]=e[r[s]]);return t}function tt(e,a,t){for(var r=0,s=a.length,o;r<s;r++)(o||!(r in a))&&(o||(o=Array.prototype.slice.call(a,0,r)),o[r]=a[r]);return e.concat(o||Array.prototype.slice.call(a))}function Q(e){return e.mode==="multiple"}function ee(e){return e.mode==="range"}function ie(e){return e.mode==="single"}var na={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function ra(e,a){return T(e,"LLLL y",a)}function sa(e,a){return T(e,"d",a)}function oa(e,a){return T(e,"LLLL",a)}function ia(e){return"".concat(e)}function la(e,a){return T(e,"cccccc",a)}function ca(e,a){return T(e,"yyyy",a)}var da=Object.freeze({__proto__:null,formatCaption:ra,formatDay:sa,formatMonthCaption:oa,formatWeekNumber:ia,formatWeekdayName:la,formatYearCaption:ca}),ua=function(e,a,t){return T(e,"do MMMM (EEEE)",t)},fa=function(){return"Month: "},ma=function(){return"Go to next month"},va=function(){return"Go to previous month"},ha=function(e,a){return T(e,"cccc",a)},xa=function(e){return"Week n. ".concat(e)},pa=function(){return"Year: "},ga=Object.freeze({__proto__:null,labelDay:ua,labelMonthDropdown:fa,labelNext:ma,labelPrevious:va,labelWeekNumber:xa,labelWeekday:ha,labelYearDropdown:pa});function ya(){var e="buttons",a=na,t=Mt,r={},s={},o=1,i={},l=new Date;return{captionLayout:e,classNames:a,formatters:da,labels:ga,locale:t,modifiersClassNames:r,modifiers:s,numberOfMonths:o,styles:i,today:l,mode:"default"}}function ba(e){var a=e.fromYear,t=e.toYear,r=e.fromMonth,s=e.toMonth,o=e.fromDate,i=e.toDate;return r?o=F(r):a&&(o=new Date(a,0,1)),s?i=we(s):t&&(i=new Date(t,11,31)),{fromDate:o?se(o):void 0,toDate:i?se(i):void 0}}var at=j.createContext(void 0);function ja(e){var a,t=e.initialProps,r=ya(),s=ba(t),o=s.fromDate,i=s.toDate,l=(a=t.captionLayout)!==null&&a!==void 0?a:r.captionLayout;l!=="buttons"&&(!o||!i)&&(l="buttons");var c;(ie(t)||Q(t)||ee(t))&&(c=t.onSelect);var f=g(g(g({},r),t),{captionLayout:l,classNames:g(g({},r.classNames),t.classNames),components:g({},t.components),formatters:g(g({},r.formatters),t.formatters),fromDate:o,labels:g(g({},r.labels),t.labels),mode:t.mode||r.mode,modifiers:g(g({},r.modifiers),t.modifiers),modifiersClassNames:g(g({},r.modifiersClassNames),t.modifiersClassNames),onSelect:c,styles:g(g({},r.styles),t.styles),toDate:i});return n.jsx(at.Provider,{value:f,children:e.children})}function D(){var e=j.useContext(at);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function nt(e){var a=D(),t=a.locale,r=a.classNames,s=a.styles,o=a.formatters.formatCaption;return n.jsx("div",{className:r.caption_label,style:s.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:o(e.displayMonth,{locale:t})})}function Na(e){return n.jsx("svg",g({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:n.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function rt(e){var a,t,r=e.onChange,s=e.value,o=e.children,i=e.caption,l=e.className,c=e.style,f=D(),u=(t=(a=f.components)===null||a===void 0?void 0:a.IconDropdown)!==null&&t!==void 0?t:Na;return n.jsxs("div",{className:l,style:c,children:[n.jsx("span",{className:f.classNames.vhidden,children:e["aria-label"]}),n.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:f.classNames.dropdown,style:f.styles.dropdown,value:s,onChange:r,children:o}),n.jsxs("div",{className:f.classNames.caption_label,style:f.styles.caption_label,"aria-hidden":"true",children:[i,n.jsx(u,{className:f.classNames.dropdown_icon,style:f.styles.dropdown_icon})]})]})}function _a(e){var a,t=D(),r=t.fromDate,s=t.toDate,o=t.styles,i=t.locale,l=t.formatters.formatMonthCaption,c=t.classNames,f=t.components,u=t.labels.labelMonthDropdown;if(!r)return n.jsx(n.Fragment,{});if(!s)return n.jsx(n.Fragment,{});var d=[];if(Qt(r,s))for(var m=F(r),v=r.getMonth();v<=s.getMonth();v++)d.push(xe(m,v));else for(var m=F(new Date),v=0;v<=11;v++)d.push(xe(m,v));var h=function(p){var w=Number(p.target.value),b=xe(F(e.displayMonth),w);e.onChange(b)},_=(a=f==null?void 0:f.Dropdown)!==null&&a!==void 0?a:rt;return n.jsx(_,{name:"months","aria-label":u(),className:c.dropdown_month,style:o.dropdown_month,onChange:h,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:i}),children:d.map(function(p){return n.jsx("option",{value:p.getMonth(),children:l(p,{locale:i})},p.getMonth())})})}function wa(e){var a,t=e.displayMonth,r=D(),s=r.fromDate,o=r.toDate,i=r.locale,l=r.styles,c=r.classNames,f=r.components,u=r.formatters.formatYearCaption,d=r.labels.labelYearDropdown,m=[];if(!s)return n.jsx(n.Fragment,{});if(!o)return n.jsx(n.Fragment,{});for(var v=s.getFullYear(),h=o.getFullYear(),_=v;_<=h;_++)m.push(Ee(Ct(new Date),_));var p=function(b){var S=Ee(F(t),Number(b.target.value));e.onChange(S)},w=(a=f==null?void 0:f.Dropdown)!==null&&a!==void 0?a:rt;return n.jsx(w,{name:"years","aria-label":d(),className:c.dropdown_year,style:l.dropdown_year,onChange:p,value:t.getFullYear(),caption:u(t,{locale:i}),children:m.map(function(b){return n.jsx("option",{value:b.getFullYear(),children:u(b,{locale:i})},b.getFullYear())})})}function Da(e,a){var t=j.useState(e),r=t[0],s=t[1],o=a===void 0?r:a;return[o,s]}function ka(e){var a=e.month,t=e.defaultMonth,r=e.today,s=a||t||r||new Date,o=e.toDate,i=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(o&&X(o,s)<0){var f=-1*(c-1);s=L(o,f)}return i&&X(s,i)<0&&(s=i),F(s)}function Ma(){var e=D(),a=ka(e),t=Da(a,e.month),r=t[0],s=t[1],o=function(i){var l;if(!e.disableNavigation){var c=F(i);s(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[r,o]}function Ca(e,a){for(var t=a.reverseMonths,r=a.numberOfMonths,s=F(e),o=F(L(s,r)),i=X(o,s),l=[],c=0;c<i;c++){var f=L(s,c);l.push(f)}return t&&(l=l.reverse()),l}function Sa(e,a){if(!a.disableNavigation){var t=a.toDate,r=a.pagedNavigation,s=a.numberOfMonths,o=s===void 0?1:s,i=r?o:1,l=F(e);if(!t)return L(l,i);var c=X(t,e);if(!(c<o))return L(l,i)}}function Pa(e,a){if(!a.disableNavigation){var t=a.fromDate,r=a.pagedNavigation,s=a.numberOfMonths,o=s===void 0?1:s,i=r?o:1,l=F(e);if(!t)return L(l,-i);var c=X(l,t);if(!(c<=0))return L(l,-i)}}var st=j.createContext(void 0);function Oa(e){var a=D(),t=Ma(),r=t[0],s=t[1],o=Ca(r,a),i=Sa(r,a),l=Pa(r,a),c=function(d){return o.some(function(m){return ke(d,m)})},f=function(d,m){c(d)||(m&&et(d,m)?s(L(d,1+a.numberOfMonths*-1)):s(d))},u={currentMonth:r,displayMonths:o,goToMonth:s,goToDate:f,previousMonth:l,nextMonth:i,isDateDisplayed:c};return n.jsx(st.Provider,{value:u,children:e.children})}function te(){var e=j.useContext(st);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function Te(e){var a,t=D(),r=t.classNames,s=t.styles,o=t.components,i=te().goToMonth,l=function(u){i(L(u,e.displayIndex?-e.displayIndex:0))},c=(a=o==null?void 0:o.CaptionLabel)!==null&&a!==void 0?a:nt,f=n.jsx(c,{id:e.id,displayMonth:e.displayMonth});return n.jsxs("div",{className:r.caption_dropdowns,style:s.caption_dropdowns,children:[n.jsx("div",{className:r.vhidden,children:f}),n.jsx(_a,{onChange:l,displayMonth:e.displayMonth}),n.jsx(wa,{onChange:l,displayMonth:e.displayMonth})]})}function Wa(e){return n.jsx("svg",g({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function Fa(e){return n.jsx("svg",g({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var oe=j.forwardRef(function(e,a){var t=D(),r=t.classNames,s=t.styles,o=[r.button_reset,r.button];e.className&&o.push(e.className);var i=o.join(" "),l=g(g({},s.button_reset),s.button);return e.style&&Object.assign(l,e.style),n.jsx("button",g({},e,{ref:a,type:"button",className:i,style:l}))});function Ia(e){var a,t,r=D(),s=r.dir,o=r.locale,i=r.classNames,l=r.styles,c=r.labels,f=c.labelPrevious,u=c.labelNext,d=r.components;if(!e.nextMonth&&!e.previousMonth)return n.jsx(n.Fragment,{});var m=f(e.previousMonth,{locale:o}),v=[i.nav_button,i.nav_button_previous].join(" "),h=u(e.nextMonth,{locale:o}),_=[i.nav_button,i.nav_button_next].join(" "),p=(a=d==null?void 0:d.IconRight)!==null&&a!==void 0?a:Fa,w=(t=d==null?void 0:d.IconLeft)!==null&&t!==void 0?t:Wa;return n.jsxs("div",{className:i.nav,style:l.nav,children:[!e.hidePrevious&&n.jsx(oe,{name:"previous-month","aria-label":m,className:v,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:s==="rtl"?n.jsx(p,{className:i.nav_icon,style:l.nav_icon}):n.jsx(w,{className:i.nav_icon,style:l.nav_icon})}),!e.hideNext&&n.jsx(oe,{name:"next-month","aria-label":h,className:_,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:s==="rtl"?n.jsx(w,{className:i.nav_icon,style:l.nav_icon}):n.jsx(p,{className:i.nav_icon,style:l.nav_icon})})]})}function Re(e){var a=D().numberOfMonths,t=te(),r=t.previousMonth,s=t.nextMonth,o=t.goToMonth,i=t.displayMonths,l=i.findIndex(function(h){return ke(e.displayMonth,h)}),c=l===0,f=l===i.length-1,u=a>1&&(c||!f),d=a>1&&(f||!c),m=function(){r&&o(r)},v=function(){s&&o(s)};return n.jsx(Ia,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:d,nextMonth:s,previousMonth:r,onPreviousClick:m,onNextClick:v})}function Aa(e){var a,t=D(),r=t.classNames,s=t.disableNavigation,o=t.styles,i=t.captionLayout,l=t.components,c=(a=l==null?void 0:l.CaptionLabel)!==null&&a!==void 0?a:nt,f;return s?f=n.jsx(c,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?f=n.jsx(Te,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?f=n.jsxs(n.Fragment,{children:[n.jsx(Te,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),n.jsx(Re,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):f=n.jsxs(n.Fragment,{children:[n.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(Re,{displayMonth:e.displayMonth,id:e.id})]}),n.jsx("div",{className:r.caption,style:o.caption,children:f})}function La(e){var a=D(),t=a.footer,r=a.styles,s=a.classNames.tfoot;return t?n.jsx("tfoot",{className:s,style:r.tfoot,children:n.jsx("tr",{children:n.jsx("td",{colSpan:8,children:t})})}):n.jsx(n.Fragment,{})}function Ea(e,a,t){for(var r=t?_e(new Date):Z(new Date,{locale:e,weekStartsOn:a}),s=[],o=0;o<7;o++){var i=O(r,o);s.push(i)}return s}function Ta(){var e=D(),a=e.classNames,t=e.styles,r=e.showWeekNumber,s=e.locale,o=e.weekStartsOn,i=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,f=Ea(s,o,i);return n.jsxs("tr",{style:t.head_row,className:a.head_row,children:[r&&n.jsx("td",{style:t.head_cell,className:a.head_cell}),f.map(function(u,d){return n.jsx("th",{scope:"col",className:a.head_cell,style:t.head_cell,"aria-label":c(u,{locale:s}),children:l(u,{locale:s})},d)})]})}function Ra(){var e,a=D(),t=a.classNames,r=a.styles,s=a.components,o=(e=s==null?void 0:s.HeadRow)!==null&&e!==void 0?e:Ta;return n.jsx("thead",{style:r.head,className:t.head,children:n.jsx(o,{})})}function Ba(e){var a=D(),t=a.locale,r=a.formatters.formatDay;return n.jsx(n.Fragment,{children:r(e.date,{locale:t})})}var Me=j.createContext(void 0);function Ya(e){if(!Q(e.initialProps)){var a={selected:void 0,modifiers:{disabled:[]}};return n.jsx(Me.Provider,{value:a,children:e.children})}return n.jsx(Ha,{initialProps:e.initialProps,children:e.children})}function Ha(e){var a=e.initialProps,t=e.children,r=a.selected,s=a.min,o=a.max,i=function(f,u,d){var m,v;(m=a.onDayClick)===null||m===void 0||m.call(a,f,u,d);var h=!!(u.selected&&s&&(r==null?void 0:r.length)===s);if(!h){var _=!!(!u.selected&&o&&(r==null?void 0:r.length)===o);if(!_){var p=r?tt([],r):[];if(u.selected){var w=p.findIndex(function(b){return W(f,b)});p.splice(w,1)}else p.push(f);(v=a.onSelect)===null||v===void 0||v.call(a,p,f,u,d)}}},l={disabled:[]};r&&l.disabled.push(function(f){var u=o&&r.length>o-1,d=r.some(function(m){return W(m,f)});return!!(u&&!d)});var c={selected:r,onDayClick:i,modifiers:l};return n.jsx(Me.Provider,{value:c,children:t})}function Ce(){var e=j.useContext(Me);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function $a(e,a){var t=a||{},r=t.from,s=t.to;return r&&s?W(s,e)&&W(r,e)?void 0:W(s,e)?{from:s,to:void 0}:W(r,e)?void 0:Ne(r,e)?{from:e,to:s}:{from:r,to:e}:s?Ne(e,s)?{from:s,to:e}:{from:e,to:s}:r?et(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var Se=j.createContext(void 0);function Ua(e){if(!ee(e.initialProps)){var a={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return n.jsx(Se.Provider,{value:a,children:e.children})}return n.jsx(za,{initialProps:e.initialProps,children:e.children})}function za(e){var a=e.initialProps,t=e.children,r=a.selected,s=r||{},o=s.from,i=s.to,l=a.min,c=a.max,f=function(v,h,_){var p,w;(p=a.onDayClick)===null||p===void 0||p.call(a,v,h,_);var b=$a(v,r);(w=a.onSelect)===null||w===void 0||w.call(a,b,v,h,_)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(o?(u.range_start=[o],i?(u.range_end=[i],W(o,i)||(u.range_middle=[{after:o,before:i}])):u.range_end=[o]):i&&(u.range_start=[i],u.range_end=[i]),l&&(o&&!i&&u.disabled.push({after:ve(o,l-1),before:O(o,l-1)}),o&&i&&u.disabled.push({after:o,before:O(o,l-1)}),!o&&i&&u.disabled.push({after:ve(i,l-1),before:O(i,l-1)})),c){if(o&&!i&&(u.disabled.push({before:O(o,-c+1)}),u.disabled.push({after:O(o,c-1)})),o&&i){var d=B(i,o)+1,m=c-d;u.disabled.push({before:ve(o,m)}),u.disabled.push({after:O(i,m)})}!o&&i&&(u.disabled.push({before:O(i,-c+1)}),u.disabled.push({after:O(i,c-1)}))}return n.jsx(Se.Provider,{value:{selected:r,onDayClick:f,modifiers:u},children:t})}function Pe(){var e=j.useContext(Se);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function re(e){return Array.isArray(e)?tt([],e):e!==void 0?[e]:[]}function Va(e){var a={};return Object.entries(e).forEach(function(t){var r=t[0],s=t[1];a[r]=re(s)}),a}var E;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(E||(E={}));var qa=E.Selected,R=E.Disabled,Ka=E.Hidden,Ga=E.Today,pe=E.RangeEnd,ge=E.RangeMiddle,ye=E.RangeStart,Za=E.Outside;function Ja(e,a,t){var r,s=(r={},r[qa]=re(e.selected),r[R]=re(e.disabled),r[Ka]=re(e.hidden),r[Ga]=[e.today],r[pe]=[],r[ge]=[],r[ye]=[],r[Za]=[],r);return e.fromDate&&s[R].push({before:e.fromDate}),e.toDate&&s[R].push({after:e.toDate}),Q(e)?s[R]=s[R].concat(a.modifiers[R]):ee(e)&&(s[R]=s[R].concat(t.modifiers[R]),s[ye]=t.modifiers[ye],s[ge]=t.modifiers[ge],s[pe]=t.modifiers[pe]),s}var ot=j.createContext(void 0);function Xa(e){var a=D(),t=Ce(),r=Pe(),s=Ja(a,t,r),o=Va(a.modifiers),i=g(g({},s),o);return n.jsx(ot.Provider,{value:i,children:e.children})}function it(){var e=j.useContext(ot);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Qa(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function en(e){return!!(e&&typeof e=="object"&&"from"in e)}function tn(e){return!!(e&&typeof e=="object"&&"after"in e)}function an(e){return!!(e&&typeof e=="object"&&"before"in e)}function nn(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function rn(e,a){var t,r=a.from,s=a.to;if(r&&s){var o=B(s,r)<0;o&&(t=[s,r],r=t[0],s=t[1]);var i=B(e,r)>=0&&B(s,e)>=0;return i}return s?W(s,e):r?W(r,e):!1}function sn(e){return Ge(e)}function on(e){return Array.isArray(e)&&e.every(Ge)}function ln(e,a){return a.some(function(t){if(typeof t=="boolean")return t;if(sn(t))return W(e,t);if(on(t))return t.includes(e);if(en(t))return rn(e,t);if(nn(t))return t.dayOfWeek.includes(e.getDay());if(Qa(t)){var r=B(t.before,e),s=B(t.after,e),o=r>0,i=s<0,l=Ne(t.before,t.after);return l?i&&o:o||i}return tn(t)?B(e,t.after)>0:an(t)?B(t.before,e)>0:typeof t=="function"?t(e):!1})}function Oe(e,a,t){var r=Object.keys(a).reduce(function(o,i){var l=a[i];return ln(e,l)&&o.push(i),o},[]),s={};return r.forEach(function(o){return s[o]=!0}),t&&!ke(e,t)&&(s.outside=!0),s}function cn(e,a){for(var t=F(e[0]),r=we(e[e.length-1]),s,o,i=t;i<=r;){var l=Oe(i,a),c=!l.disabled&&!l.hidden;if(!c){i=O(i,1);continue}if(l.selected)return i;l.today&&!o&&(o=i),s||(s=i),i=O(i,1)}return o||s}var dn=365;function lt(e,a){var t=a.moveBy,r=a.direction,s=a.context,o=a.modifiers,i=a.retry,l=i===void 0?{count:0,lastFocused:e}:i,c=s.weekStartsOn,f=s.fromDate,u=s.toDate,d=s.locale,m={day:O,week:je,month:L,year:zt,startOfWeek:function(p){return s.ISOWeek?_e(p):Z(p,{locale:d,weekStartsOn:c})},endOfWeek:function(p){return s.ISOWeek?Qe(p):De(p,{locale:d,weekStartsOn:c})}},v=m[t](e,r==="after"?1:-1);r==="before"&&f?v=Vt([f,v]):r==="after"&&u&&(v=qt([u,v]));var h=!0;if(o){var _=Oe(v,o);h=!_.disabled&&!_.hidden}return h?v:l.count>dn?l.lastFocused:lt(v,{moveBy:t,direction:r,context:s,modifiers:o,retry:g(g({},l),{count:l.count+1})})}var ct=j.createContext(void 0);function un(e){var a=te(),t=it(),r=j.useState(),s=r[0],o=r[1],i=j.useState(),l=i[0],c=i[1],f=cn(a.displayMonths,t),u=s??(l&&a.isDateDisplayed(l))?l:f,d=function(){c(s),o(void 0)},m=function(p){o(p)},v=D(),h=function(p,w){if(s){var b=lt(s,{moveBy:p,direction:w,context:v,modifiers:t});W(s,b)||(a.goToDate(b,s),m(b))}},_={focusedDay:s,focusTarget:u,blur:d,focus:m,focusDayAfter:function(){return h("day","after")},focusDayBefore:function(){return h("day","before")},focusWeekAfter:function(){return h("week","after")},focusWeekBefore:function(){return h("week","before")},focusMonthBefore:function(){return h("month","before")},focusMonthAfter:function(){return h("month","after")},focusYearBefore:function(){return h("year","before")},focusYearAfter:function(){return h("year","after")},focusStartOfWeek:function(){return h("startOfWeek","before")},focusEndOfWeek:function(){return h("endOfWeek","after")}};return n.jsx(ct.Provider,{value:_,children:e.children})}function We(){var e=j.useContext(ct);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function fn(e,a){var t=it(),r=Oe(e,t,a);return r}var Fe=j.createContext(void 0);function mn(e){if(!ie(e.initialProps)){var a={selected:void 0};return n.jsx(Fe.Provider,{value:a,children:e.children})}return n.jsx(vn,{initialProps:e.initialProps,children:e.children})}function vn(e){var a=e.initialProps,t=e.children,r=function(o,i,l){var c,f,u;if((c=a.onDayClick)===null||c===void 0||c.call(a,o,i,l),i.selected&&!a.required){(f=a.onSelect)===null||f===void 0||f.call(a,void 0,o,i,l);return}(u=a.onSelect)===null||u===void 0||u.call(a,o,o,i,l)},s={selected:a.selected,onDayClick:r};return n.jsx(Fe.Provider,{value:s,children:t})}function dt(){var e=j.useContext(Fe);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function hn(e,a){var t=D(),r=dt(),s=Ce(),o=Pe(),i=We(),l=i.focusDayAfter,c=i.focusDayBefore,f=i.focusWeekAfter,u=i.focusWeekBefore,d=i.blur,m=i.focus,v=i.focusMonthBefore,h=i.focusMonthAfter,_=i.focusYearBefore,p=i.focusYearAfter,w=i.focusStartOfWeek,b=i.focusEndOfWeek,S=function(y){var x,le,ce,de;ie(t)?(x=r.onDayClick)===null||x===void 0||x.call(r,e,a,y):Q(t)?(le=s.onDayClick)===null||le===void 0||le.call(s,e,a,y):ee(t)?(ce=o.onDayClick)===null||ce===void 0||ce.call(o,e,a,y):(de=t.onDayClick)===null||de===void 0||de.call(t,e,a,y)},C=function(y){var x;m(e),(x=t.onDayFocus)===null||x===void 0||x.call(t,e,a,y)},P=function(y){var x;d(),(x=t.onDayBlur)===null||x===void 0||x.call(t,e,a,y)},A=function(y){var x;(x=t.onDayMouseEnter)===null||x===void 0||x.call(t,e,a,y)},M=function(y){var x;(x=t.onDayMouseLeave)===null||x===void 0||x.call(t,e,a,y)},N=function(y){var x;(x=t.onDayPointerEnter)===null||x===void 0||x.call(t,e,a,y)},Y=function(y){var x;(x=t.onDayPointerLeave)===null||x===void 0||x.call(t,e,a,y)},z=function(y){var x;(x=t.onDayTouchCancel)===null||x===void 0||x.call(t,e,a,y)},ft=function(y){var x;(x=t.onDayTouchEnd)===null||x===void 0||x.call(t,e,a,y)},mt=function(y){var x;(x=t.onDayTouchMove)===null||x===void 0||x.call(t,e,a,y)},vt=function(y){var x;(x=t.onDayTouchStart)===null||x===void 0||x.call(t,e,a,y)},ht=function(y){var x;(x=t.onDayKeyUp)===null||x===void 0||x.call(t,e,a,y)},xt=function(y){var x;switch(y.key){case"ArrowLeft":y.preventDefault(),y.stopPropagation(),t.dir==="rtl"?l():c();break;case"ArrowRight":y.preventDefault(),y.stopPropagation(),t.dir==="rtl"?c():l();break;case"ArrowDown":y.preventDefault(),y.stopPropagation(),f();break;case"ArrowUp":y.preventDefault(),y.stopPropagation(),u();break;case"PageUp":y.preventDefault(),y.stopPropagation(),y.shiftKey?_():v();break;case"PageDown":y.preventDefault(),y.stopPropagation(),y.shiftKey?p():h();break;case"Home":y.preventDefault(),y.stopPropagation(),w();break;case"End":y.preventDefault(),y.stopPropagation(),b();break}(x=t.onDayKeyDown)===null||x===void 0||x.call(t,e,a,y)},pt={onClick:S,onFocus:C,onBlur:P,onKeyDown:xt,onKeyUp:ht,onMouseEnter:A,onMouseLeave:M,onPointerEnter:N,onPointerLeave:Y,onTouchCancel:z,onTouchEnd:ft,onTouchMove:mt,onTouchStart:vt};return pt}function xn(){var e=D(),a=dt(),t=Ce(),r=Pe(),s=ie(e)?a.selected:Q(e)?t.selected:ee(e)?r.selected:void 0;return s}function pn(e){return Object.values(E).includes(e)}function gn(e,a){var t=[e.classNames.day];return Object.keys(a).forEach(function(r){var s=e.modifiersClassNames[r];if(s)t.push(s);else if(pn(r)){var o=e.classNames["day_".concat(r)];o&&t.push(o)}}),t}function yn(e,a){var t=g({},e.styles.day);return Object.keys(a).forEach(function(r){var s;t=g(g({},t),(s=e.modifiersStyles)===null||s===void 0?void 0:s[r])}),t}function bn(e,a,t){var r,s,o,i=D(),l=We(),c=fn(e,a),f=hn(e,c),u=xn(),d=!!(i.onDayClick||i.mode!=="default");j.useEffect(function(){var A;c.outside||l.focusedDay&&d&&W(l.focusedDay,e)&&((A=t.current)===null||A===void 0||A.focus())},[l.focusedDay,e,t,d,c.outside]);var m=gn(i,c).join(" "),v=yn(i,c),h=!!(c.outside&&!i.showOutsideDays||c.hidden),_=(o=(s=i.components)===null||s===void 0?void 0:s.DayContent)!==null&&o!==void 0?o:Ba,p=n.jsx(_,{date:e,displayMonth:a,activeModifiers:c}),w={style:v,className:m,children:p,role:"gridcell"},b=l.focusTarget&&W(l.focusTarget,e)&&!c.outside,S=l.focusedDay&&W(l.focusedDay,e),C=g(g(g({},w),(r={disabled:c.disabled,role:"gridcell"},r["aria-selected"]=c.selected,r.tabIndex=S||b?0:-1,r)),f),P={isButton:d,isHidden:h,activeModifiers:c,selectedDays:u,buttonProps:C,divProps:w};return P}function jn(e){var a=j.useRef(null),t=bn(e.date,e.displayMonth,a);return t.isHidden?n.jsx("div",{role:"gridcell"}):t.isButton?n.jsx(oe,g({name:"day",ref:a},t.buttonProps)):n.jsx("div",g({},t.divProps))}function Nn(e){var a=e.number,t=e.dates,r=D(),s=r.onWeekNumberClick,o=r.styles,i=r.classNames,l=r.locale,c=r.labels.labelWeekNumber,f=r.formatters.formatWeekNumber,u=f(Number(a),{locale:l});if(!s)return n.jsx("span",{className:i.weeknumber,style:o.weeknumber,children:u});var d=c(Number(a),{locale:l}),m=function(v){s(a,t,v)};return n.jsx(oe,{name:"week-number","aria-label":d,className:i.weeknumber,style:o.weeknumber,onClick:m,children:u})}function _n(e){var a,t,r=D(),s=r.styles,o=r.classNames,i=r.showWeekNumber,l=r.components,c=(a=l==null?void 0:l.Day)!==null&&a!==void 0?a:jn,f=(t=l==null?void 0:l.WeekNumber)!==null&&t!==void 0?t:Nn,u;return i&&(u=n.jsx("td",{className:o.cell,style:s.cell,children:n.jsx(f,{number:e.weekNumber,dates:e.dates})})),n.jsxs("tr",{className:o.row,style:s.row,children:[u,e.dates.map(function(d){return n.jsx("td",{className:o.cell,style:s.cell,role:"presentation",children:n.jsx(c,{displayMonth:e.displayMonth,date:d})},Zt(d))})]})}function Be(e,a,t){for(var r=t!=null&&t.ISOWeek?Qe(a):De(a,t),s=t!=null&&t.ISOWeek?_e(e):Z(e,t),o=B(r,s),i=[],l=0;l<=o;l++)i.push(O(s,l));var c=i.reduce(function(f,u){var d=t!=null&&t.ISOWeek?St(u):Pt(u,t),m=f.find(function(v){return v.weekNumber===d});return m?(m.dates.push(u),f):(f.push({weekNumber:d,dates:[u]}),f)},[]);return c}function wn(e,a){var t=Be(F(e),we(e),a);if(a!=null&&a.useFixedWeeks){var r=Xt(e,a);if(r<6){var s=t[t.length-1],o=s.dates[s.dates.length-1],i=je(o,6-r),l=Be(je(o,1),i,a);t.push.apply(t,l)}}return t}function Dn(e){var a,t,r,s=D(),o=s.locale,i=s.classNames,l=s.styles,c=s.hideHead,f=s.fixedWeeks,u=s.components,d=s.weekStartsOn,m=s.firstWeekContainsDate,v=s.ISOWeek,h=wn(e.displayMonth,{useFixedWeeks:!!f,ISOWeek:v,locale:o,weekStartsOn:d,firstWeekContainsDate:m}),_=(a=u==null?void 0:u.Head)!==null&&a!==void 0?a:Ra,p=(t=u==null?void 0:u.Row)!==null&&t!==void 0?t:_n,w=(r=u==null?void 0:u.Footer)!==null&&r!==void 0?r:La;return n.jsxs("table",{id:e.id,className:i.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&n.jsx(_,{}),n.jsx("tbody",{className:i.tbody,style:l.tbody,children:h.map(function(b){return n.jsx(p,{displayMonth:e.displayMonth,dates:b.dates,weekNumber:b.weekNumber},b.weekNumber)})}),n.jsx(w,{displayMonth:e.displayMonth})]})}function kn(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Mn=kn()?j.useLayoutEffect:j.useEffect,be=!1,Cn=0;function Ye(){return"react-day-picker-".concat(++Cn)}function Sn(e){var a,t=e??(be?Ye():null),r=j.useState(t),s=r[0],o=r[1];return Mn(function(){s===null&&o(Ye())},[]),j.useEffect(function(){be===!1&&(be=!0)},[]),(a=e??s)!==null&&a!==void 0?a:void 0}function Pn(e){var a,t,r=D(),s=r.dir,o=r.classNames,i=r.styles,l=r.components,c=te().displayMonths,f=Sn(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),u=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,d=[o.month],m=i.month,v=e.displayIndex===0,h=e.displayIndex===c.length-1,_=!v&&!h;s==="rtl"&&(a=[v,h],h=a[0],v=a[1]),v&&(d.push(o.caption_start),m=g(g({},m),i.caption_start)),h&&(d.push(o.caption_end),m=g(g({},m),i.caption_end)),_&&(d.push(o.caption_between),m=g(g({},m),i.caption_between));var p=(t=l==null?void 0:l.Caption)!==null&&t!==void 0?t:Aa;return n.jsxs("div",{className:d.join(" "),style:m,children:[n.jsx(p,{id:f,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(Dn,{id:u,"aria-labelledby":f,displayMonth:e.displayMonth})]},e.displayIndex)}function On(e){var a=D(),t=a.classNames,r=a.styles;return n.jsx("div",{className:t.months,style:r.months,children:e.children})}function Wn(e){var a,t,r=e.initialProps,s=D(),o=We(),i=te(),l=j.useState(!1),c=l[0],f=l[1];j.useEffect(function(){s.initialFocus&&o.focusTarget&&(c||(o.focus(o.focusTarget),f(!0)))},[s.initialFocus,c,o.focus,o.focusTarget,o]);var u=[s.classNames.root,s.className];s.numberOfMonths>1&&u.push(s.classNames.multiple_months),s.showWeekNumber&&u.push(s.classNames.with_weeknumber);var d=g(g({},s.styles.root),s.style),m=Object.keys(r).filter(function(h){return h.startsWith("data-")}).reduce(function(h,_){var p;return g(g({},h),(p={},p[_]=r[_],p))},{}),v=(t=(a=r.components)===null||a===void 0?void 0:a.Months)!==null&&t!==void 0?t:On;return n.jsx("div",g({className:u.join(" "),style:d,dir:s.dir,id:s.id,nonce:r.nonce,title:r.title,lang:r.lang},m,{children:n.jsx(v,{children:i.displayMonths.map(function(h,_){return n.jsx(Pn,{displayIndex:_,displayMonth:h},_)})})}))}function Fn(e){var a=e.children,t=aa(e,["children"]);return n.jsx(ja,{initialProps:t,children:n.jsx(Oa,{children:n.jsx(mn,{initialProps:t,children:n.jsx(Ya,{initialProps:t,children:n.jsx(Ua,{initialProps:t,children:n.jsx(Xa,{children:n.jsx(un,{children:a})})})})})})})}function In(e){return n.jsx(Fn,g({},e,{children:n.jsx(Wn,{initialProps:e})}))}function ut({className:e,classNames:a,showOutsideDays:t=!0,...r}){return n.jsx(In,{showOutsideDays:t,className:ue("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:ue(Ie({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:ue(Ie({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...a},components:{IconLeft:({...s})=>n.jsx(Wt,{className:"h-4 w-4"}),IconRight:({...s})=>n.jsx(Ot,{className:"h-4 w-4"})},...r})}ut.displayName="Calendar";const He=["07:00","08:00","09:00","10:00","11:00","13:00","14:00","15:00","16:00","17:00","18:00"];function An({instructorId:e,instructorName:a,pricePerHour:t,onSuccess:r}){const[s,o]=j.useState(),[i,l]=j.useState(null),{data:c,isLoading:f}=Bt(e),u=Yt(),d=Xe(),m=Ke(),v=j.useMemo(()=>c?c.map(b=>b.day_of_week):[],[c]),h=b=>{const S=b.getDay(),C=new Date;return C.setHours(0,0,0,0),!!(b<C||c!=null&&c.length&&!v.includes(S))},p=s?(b=>{if(!(c!=null&&c.length))return He;const S=b.getDay(),C=c.filter(P=>P.day_of_week===S);return C.length?He.filter(P=>{const[A]=P.split(":").map(Number);return C.some(M=>{const N=parseInt(M.start_time.split(":")[0]),Y=parseInt(M.end_time.split(":")[0]);return A>=N&&A<Y})}):[]})(s):[],w=async()=>{if(!s||!i)return;const[b,S]=i.split(":").map(Number),C=ta(ea(s,b),S);try{const{data:{user:P}}=await I.auth.getUser(),A=await u.mutateAsync({instructorId:e,scheduledAt:C,durationMinutes:60,price:t});try{const{data:M}=await I.from("profiles").select("name").eq("user_id",P==null?void 0:P.id).single();await I.functions.invoke("send-booking-email",{body:{instructorId:e,studentName:(M==null?void 0:M.name)||"Aluno",scheduledAt:C.toISOString(),price:t}}),console.log("Booking email sent")}catch(M){console.error("Error sending booking email:",M)}o(void 0),l(null);try{const M=await d.mutateAsync(e);m(`/mensagens?conversa=${M.id}`),V.success("Aula agendada! Combinando detalhes no chat...")}catch(M){console.error("Error creating conversation:",M),m("/mensagens")}r==null||r()}catch{}};return f?n.jsx("div",{className:"flex justify-center py-8",children:n.jsx(J,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[n.jsxs(H,{children:[n.jsx(q,{children:n.jsx(K,{className:"text-lg",children:"Selecione a data"})}),n.jsx($,{children:n.jsx(ut,{mode:"single",selected:s,onSelect:b=>{o(b),l(null)},disabled:h,locale:ne,className:"rounded-md border"})})]}),n.jsxs(H,{children:[n.jsx(q,{children:n.jsx(K,{className:"text-lg",children:"Selecione o horário"})}),n.jsx($,{children:s?n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:T(s,"EEEE, d 'de' MMMM",{locale:ne})}),p.length>0?n.jsx("div",{className:"grid grid-cols-3 gap-2",children:p.map(b=>n.jsxs(U,{variant:i===b?"default":"outline",size:"sm",onClick:()=>l(b),className:"gap-1",children:[n.jsx(Ze,{className:"h-3 w-3"}),b]},b))}):n.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum horário disponível nesta data."})]}):n.jsx("p",{className:"text-sm text-muted-foreground",children:"Selecione uma data para ver os horários disponíveis."})})]})]}),s&&i&&n.jsx(H,{className:"bg-muted/50",children:n.jsx($,{className:"p-4",children:n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Resumo do agendamento"}),n.jsxs("p",{className:"font-semibold",children:[T(s,"d 'de' MMMM",{locale:ne})," às ",i]}),n.jsxs("p",{className:"text-sm",children:["Instrutor: ",a]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Valor"}),n.jsxs("p",{className:"text-2xl font-bold",children:["R$ ",t]})]}),n.jsx(U,{onClick:w,disabled:u.isPending,className:"w-full md:w-auto",children:u.isPending?n.jsxs(n.Fragment,{children:[n.jsx(J,{className:"mr-2 h-4 w-4 animate-spin"}),"Agendando..."]}):"Confirmar Agendamento"})]})})})]})}const $e=5;function Ln({open:e,onOpenChange:a,onPaymentSuccess:t,instructorName:r,instructorId:s,actionType:o}){const[i,l]=j.useState(!1),{toast:c}=gt(),f={booking:"confirmar o agendamento",whatsapp:"ver o WhatsApp do instrutor",message:"enviar mensagem"},u=async()=>{var d;l(!0);try{const{data:m}=await I.auth.getSession();if(!((d=m==null?void 0:m.session)!=null&&d.access_token)){c({title:"Erro",description:"Você precisa estar logado para continuar",variant:"destructive"});return}const{data:v,error:h}=await I.functions.invoke("create-payment",{headers:{Authorization:`Bearer ${m.session.access_token}`},body:{instructor_id:s}});if(h)throw h;v!=null&&v.url&&(sessionStorage.setItem("paymentCallback",JSON.stringify({action:o,instructorId:s,instructorName:r,timestamp:Date.now()})),window.location.href=v.url)}catch(m){c({title:"Erro no pagamento",description:m.message||"Não foi possível processar o pagamento",variant:"destructive"})}finally{l(!1)}};return n.jsx(Ue,{open:e,onOpenChange:a,children:n.jsxs(ze,{className:"max-w-md",children:[n.jsxs(Ve,{children:[n.jsx(qe,{className:"text-center text-xl",children:"Taxa de Serviço"}),n.jsxs(bt,{className:"text-center",children:["Para ",f[o]," com ",n.jsx("strong",{children:r})]})]}),n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"text-center p-6 bg-primary/5 rounded-2xl border border-primary/20",children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Valor único"}),n.jsxs("div",{className:"text-5xl font-black text-primary",children:["R$ ",$e.toFixed(2).replace(".",",")]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Pagamento único por agendamento"})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[n.jsx(he,{className:"h-5 w-5 text-green-500 shrink-0"}),n.jsx("span",{children:"Acesso ao WhatsApp do instrutor"})]}),n.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[n.jsx(he,{className:"h-5 w-5 text-green-500 shrink-0"}),n.jsx("span",{children:"Chat direto para combinar detalhes"})]}),n.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[n.jsx(he,{className:"h-5 w-5 text-green-500 shrink-0"}),n.jsx("span",{children:"Confirmação do agendamento"})]})]}),n.jsx(U,{onClick:u,disabled:i,className:"w-full h-12 text-lg font-semibold gap-2",children:i?n.jsxs(n.Fragment,{children:[n.jsx(J,{className:"h-5 w-5 animate-spin"}),"Processando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Ft,{className:"h-5 w-5"}),"Pagar R$ ",$e.toFixed(2).replace(".",",")]})}),n.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-muted-foreground",children:[n.jsx(Je,{className:"h-4 w-4"}),"Pagamento seguro via Stripe"]})]})]})})}function En(e){const[a,t]=j.useState({hasAccess:!1}),[r,s]=j.useState(!0),o=j.useCallback(async()=>{if(!e){s(!1);return}try{const{data:{user:i}}=await I.auth.getUser();if(!i){t({hasAccess:!1}),s(!1);return}const{data:l,error:c}=await I.from("student_instructor_access").select("*").eq("student_id",i.id).eq("instructor_id",e).maybeSingle();if(c)console.error("Error checking access:",c),t({hasAccess:!1});else if(l){const f=new Date,u=l.expires_at?new Date(l.expires_at):null,d=!u||f<u;t({hasAccess:d,paidAt:l.paid_at,expiresAt:l.expires_at||void 0})}else t({hasAccess:!1})}catch(i){console.error("Error checking student access:",i),t({hasAccess:!1})}finally{s(!1)}},[e]);return j.useEffect(()=>{o()},[o]),j.useEffect(()=>{if(!e)return;const i=I.channel(`student-access-${e}`).on("postgres_changes",{event:"*",schema:"public",table:"student_instructor_access"},()=>{o()}).subscribe();return()=>{I.removeChannel(i)}},[e,o]),{...a,isLoading:r,refetch:o}}function Jn(){const{id:e}=jt(),a=Ke(),[t]=Nt(),[r,s]=j.useState(!1),[o,i]=j.useState(!1),[l,c]=j.useState(!1),[f,u]=j.useState(null),{data:d,isLoading:m}=yt(e||""),{data:v}=wt(e||""),h=Xe(),{hasAccess:_,refetch:p}=En(e||null);j.useEffect(()=>{t.get("payment")==="success"&&(p(),V.success("Pagamento confirmado! Agora você pode entrar em contato."))},[t,p]),j.useEffect(()=>{e&&Ut(e)},[e]);const w=N=>_?!1:(u(N),c(!0),!0),b=async()=>{await p(),c(!1),f==="booking"?i(!0):f==="whatsapp"?S():f==="message"&&C(),u(null)},S=()=>{if(!d)return;const N=d;if(N.phone){const Y=encodeURIComponent(`Olá ${d.name}! Vi seu perfil na plataforma Instrutores na Direção e gostaria de saber mais sobre suas aulas.`);window.open(`https://wa.me/55${N.phone.replace(/\D/g,"")}?text=${Y}`,"_blank")}else V.error("Não foi possível obter o número do instrutor")},C=async()=>{try{const N=await h.mutateAsync(e);a(`/mensagens?conversa=${N.id}`)}catch(N){console.error("Error creating conversation:",N)}},P=async()=>{if(!d)return;const{data:{user:N}}=await I.auth.getUser();if(!N){V.error("Faça login para chamar no WhatsApp"),a("/login");return}w("whatsapp")||S()},A=async()=>{const{data:{user:N}}=await I.auth.getUser();if(!N){V.error("Faça login para enviar mensagens"),a("/login");return}w("message")||C()},M=async()=>{const{data:{user:N}}=await I.auth.getUser();if(!N){V.error("Faça login para agendar aulas"),a("/login");return}w("booking")||i(!0)};return m?n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(fe,{}),n.jsx("main",{className:"flex-1 flex items-center justify-center",children:n.jsx(J,{className:"h-8 w-8 animate-spin text-muted-foreground"})}),n.jsx(me,{})]}):d?n.jsxs(n.Fragment,{children:[n.jsxs(_t,{children:[n.jsxs("title",{children:[d.name," - Instrutor de Direção em ",d.city," | Instrutores na Direção"]}),n.jsx("meta",{name:"description",content:`${d.name} - Instrutor de direção em ${d.city}, ${d.state}. ${d.experience||"Experiência comprovada"}. Avaliação ${d.rating||0}/5. Agende sua aula!`})]}),n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(fe,{}),n.jsxs("main",{className:"flex-1",children:[n.jsx("div",{className:"relative h-48 md:h-64 bg-primary",children:n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-primary/80 to-transparent"})}),n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsx("div",{className:"relative -mt-20 mb-8",children:n.jsxs("div",{className:"flex flex-col gap-6 items-start md:items-start md:justify-start px-[10px] py-[10px] mx-[10px] my-[50px] md:flex md:flex-row",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:d.avatar_url||`https://ui-avatars.com/api/?name=${encodeURIComponent(d.name)}&size=160`,alt:d.name,className:"w-32 h-32 md:w-40 md:h-40 rounded-2xl border-4 border-card shadow-lg object-cover bg-muted"}),n.jsx("div",{className:"absolute -bottom-2 -right-2 bg-accent text-accent-foreground p-2 rounded-full",children:n.jsx(Je,{className:"h-5 w-5"})})]}),n.jsx("div",{className:"flex-1 pt-4 md:pt-8",children:n.jsxs("div",{className:"flex flex-wrap items-start gap-4 justify-between",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex flex-col gap-2 mb-1",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-foreground",children:d.name}),n.jsx(Ht,{planType:d.plan_type||"trial",size:"md"})]}),n.jsx($t,{planType:d.plan_type,size:"md"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground mb-2",children:[n.jsx(It,{className:"h-4 w-4"}),n.jsxs("span",{children:[d.city,", ",d.state]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ae,{className:"h-5 w-5 fill-warning text-warning"}),n.jsx("span",{className:"font-bold text-foreground",children:d.rating||0}),n.jsxs("span",{className:"text-muted-foreground",children:["(",d.total_reviews||0," avaliações)"]})]}),n.jsxs(Ae,{className:"bg-accent/10 text-accent border-accent/20",children:[n.jsx(Ze,{className:"h-3 w-3 mr-1"}),"Disponível"]})]})]}),n.jsx(U,{variant:"outline",size:"icon",onClick:()=>s(!r),className:"rounded-full",children:n.jsx(At,{className:`h-5 w-5 ${r?"fill-destructive text-destructive":""}`})})]})})]})}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 pb-12",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[n.jsxs(H,{children:[n.jsx(q,{children:n.jsx(K,{children:"Sobre mim"})}),n.jsx($,{children:n.jsx("p",{className:"text-foreground whitespace-pre-line leading-relaxed",children:d.bio||"Instrutor de direção qualificado e dedicado a ajudar você a conquistar sua CNH."})})]}),d.specialties&&d.specialties.length>0&&n.jsxs(H,{children:[n.jsx(q,{children:n.jsx(K,{children:"Especialidades"})}),n.jsx($,{children:n.jsx("div",{className:"flex flex-wrap gap-2",children:d.specialties.map(N=>n.jsx(Ae,{variant:"secondary",className:"text-sm py-1 px-3",children:N},N))})})]}),d.neighborhoods&&n.jsxs(H,{children:[n.jsx(q,{children:n.jsx(K,{children:"Bairros atendidos"})}),n.jsx($,{children:n.jsx("p",{className:"text-foreground",children:d.neighborhoods})})]}),n.jsxs(H,{children:[n.jsxs(q,{className:"flex flex-row items-center justify-between",children:[n.jsx(K,{children:"Avaliações"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ae,{className:"h-5 w-5 fill-warning text-warning"}),n.jsx("span",{className:"font-bold",children:d.rating||0}),n.jsxs("span",{className:"text-muted-foreground",children:["(",d.total_reviews||0,")"]})]})]}),n.jsx($,{children:v&&v.length>0?n.jsx("div",{className:"space-y-6",children:v.map(N=>n.jsx("div",{className:"pb-6 border-b last:border-0 last:pb-0",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("img",{src:N.student_avatar||`https://ui-avatars.com/api/?name=${encodeURIComponent(N.student_name||"Aluno")}&size=48`,alt:N.student_name||"Aluno",className:"w-12 h-12 rounded-full object-cover bg-muted"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h4",{className:"font-medium text-foreground",children:N.student_name||"Aluno"}),n.jsx("span",{className:"text-sm text-muted-foreground",children:T(new Date(N.created_at),"d 'de' MMMM 'de' yyyy",{locale:ne})})]}),n.jsx("div",{className:"flex gap-0.5 mb-2",children:Array.from({length:N.rating}).map((Y,z)=>n.jsx(ae,{className:"h-4 w-4 fill-warning text-warning"},z))}),N.comment&&n.jsx("p",{className:"text-foreground",children:N.comment}),N.photos&&N.photos.length>0&&n.jsx("div",{className:"flex gap-2 mt-3",children:N.photos.map((Y,z)=>n.jsx("img",{src:Y,alt:`Foto ${z+1}`,className:"h-20 w-20 rounded-lg object-cover"},z))})]})]})},N.id))}):n.jsx("p",{className:"text-muted-foreground",children:"Nenhuma avaliação ainda."})})]})]}),n.jsx("div",{className:"space-y-6",children:n.jsx(H,{className:"sticky top-24",children:n.jsxs($,{className:"p-6",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"A partir de"}),n.jsx("div",{className:"text-4xl font-bold text-foreground",children:I.auth.getUser().then(({data:N})=>N.user)?n.jsxs(n.Fragment,{children:["R$ ",d.price||0,n.jsx("span",{className:"text-lg font-normal text-muted-foreground",children:"/aula"})]}):n.jsx("div",{className:"text-xl text-primary mt-2",children:"Faça login para ver"})})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs(U,{size:"lg",className:"w-full gap-2",onClick:M,children:[n.jsx(Lt,{className:"h-5 w-5"}),"Agendar Aula"]}),n.jsx(Ue,{open:o,onOpenChange:i,children:n.jsxs(ze,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[n.jsx(Ve,{children:n.jsxs(qe,{children:["Agendar aula com ",d.name]})}),n.jsx(An,{instructorId:d.id,instructorName:d.name,pricePerHour:d.price||0,onSuccess:()=>i(!1)})]})}),n.jsxs(U,{size:"lg",variant:"whatsapp",className:"w-full gap-2",onClick:P,children:[n.jsx(Et,{className:"h-5 w-5"}),"Chamar no WhatsApp"]}),n.jsxs(U,{size:"lg",variant:"outline",className:"w-full gap-2",onClick:A,disabled:h.isPending,children:[h.isPending?n.jsx(J,{className:"h-5 w-5 animate-spin"}):n.jsx(Tt,{className:"h-5 w-5"}),"Enviar mensagem"]})]}),n.jsx("hr",{className:"my-6"}),n.jsxs("div",{className:"space-y-4 text-sm",children:[d.experience&&n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-muted-foreground flex items-center gap-2",children:[n.jsx(Rt,{className:"h-4 w-4"}),"Experiência"]}),n.jsx("span",{className:"font-medium text-foreground",children:d.experience})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-muted-foreground flex items-center gap-2",children:[n.jsx(ae,{className:"h-4 w-4"}),"Avaliação"]}),n.jsxs("span",{className:"font-medium text-foreground",children:[d.rating||0,"/5"]})]})]})]})})})]})]})]}),n.jsx(me,{}),n.jsx(Ln,{open:l,onOpenChange:c,onPaymentSuccess:b,instructorName:(d==null?void 0:d.name)||"",instructorId:(d==null?void 0:d.id)||"",actionType:f||"booking"})]})]}):n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(fe,{}),n.jsx("main",{className:"flex-1 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Instrutor não encontrado"}),n.jsx("p",{className:"text-muted-foreground",children:"Este perfil não existe ou foi removido."})]})}),n.jsx(me,{})]})}export{Jn as default};
